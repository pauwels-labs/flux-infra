apiVersion: v1
kind: Secret
metadata:
  labels:
    app.kubernetes.io/component: grafana
    app.kubernetes.io/name: grafana
    app.kubernetes.io/part-of: kube-prometheus
    app.kubernetes.io/version: 9.2.0
  name: grafana-config
  namespace: ${infranamespaceprefix}monitoring
stringData:
  grafana.ini: |
    [auth.jwt]
    allow_assign_grafana_admin = true
    auto_sign_up = true
    email_claim = email
    enabled = true
    expect_claims = {"iss": "https://identity.pauwelslabs.com/realms/pauwels-labs-main"}
    header_name = x-forwarded-access-token
    jwk_set_url = https://identity.pauwelslabs.com/realms/pauwels-labs-main/protocol/openid-connect/certs
    role_attribute_path = groups[?contains(@, '/root/admins') || contains(@, '/grafana/admins')] && 'GrafanaAdmin' || groups[?contains(@, '/root/writers') || contains(@, '/grafana/writers')] && 'Editor' || 'Viewer'
    username_claim = preferred_username
    [date_formats]
    default_timezone = UTC
    [server]
    root_url = https://dashboards.pauwelslabs.com
type: Opaque
