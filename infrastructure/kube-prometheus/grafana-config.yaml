apiVersion: v1
kind: Secret
metadata:
  labels:
    app.kubernetes.io/component: grafana
    app.kubernetes.io/name: grafana
    app.kubernetes.io/part-of: kube-prometheus
    app.kubernetes.io/version: 9.2.0
  name: grafana-config
  namespace: monitoring
stringData:
  grafana.ini: |
    [auth.basic]
    enabled = false
    [auth.jwt]
    auto_sign_up = true
    email_claim = email
    enabled = true
    expect_claims = {"iss": "https://identity.pauwelslabs.com/realms/pauwels-labs"}
    header_name = x-forwarded-access-token
    jwk_set_url = https://identity.pauwelslabs.com/realms/pauwels-labs/protocol/openid-connect/certs
    role_attribute_path = contains(resource_access.pauwels-labs-login.roles[*], 'dashboards-admin') && 'Admin' || contains(resource_access.pauwels-labs-login.roles[*], 'dashboards-editor') && 'Editor' || 'Viewer'
    username_claim = preferred_username
    [auth.proxy]
    auto_sign_up = true
    enabled = false
    header_name = x-forwarded-preferred-username
    header_property = username
    headers = id:x-forwarded-user groups:x-forwarded-groups
    sync_ttl = 60
    [date_formats]
    default_timezone = UTC
    [server]
    root_url = https://dashboards.pauwelslabs.com
type: Opaque
